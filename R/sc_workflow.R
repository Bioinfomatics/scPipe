

#' @name create_scd_by_dir
#' create SCData object from data folder generated by preprocessing step
#' 
#' after we run \code{sc_gene_counting} and finish the preprocessing step. \code{create_scd_by_dir}
#' can be used to generate the SCData obeject from the folder that contains gene counting matrix and QC statistics.
#'
#' @param datadir the directory that contains all the data and `stat` subfolder.
#' @param org the organism of the data. List of possible names can be retrieved using the function 
#' `listDatasets`from `biomaRt` package. (i.e `mmusculus_gene_ensembl` or `hsapiens_gene_ensembl`)
#' @param gene_id gene id type of the data A possible list of ids can be retrieved using the function `listAttributes` from `biomaRt` package. 
#' the commonly used id types are `external_gene_name`, `ensembl_gene_id` or `entrezgene`
#' @param pheno_data the external phenotype data that linked to each single cell. this should be an \code{AnnotatedDataFrame} object
#' 
#' @details after we run \code{sc_gene_counting} and finish the preprocessing step. \code{create_scd_by_dir}
#' can be used to generate the SCData obeject from the folder that contains gene counting matrix and QC statistics.
#' 
#' @return an SCData object
#'
#'
#' @export

create_scd_by_dir = function(datadir, org=NULL, gene_id=NULL, pheno_data=NULL){
  gene_cnt = read.csv(file.path(datadir, "gene_count.csv"),row.names=1)
  cell_stat = read.csv(file.path(datadir,"stat","cell_stat.csv"),row.names=1)
  
  gene_cnt = gene_cnt[,order(colnames(gene_cnt))]
  cell_stat = cell_stat[order(rownames(cell_stat)),]
  
  
  QualityControlInfo = new("AnnotatedDataFrame", data = as.data.frame(cell_stat))
  scd = newSCData(countData = as.matrix(gene_cnt),
                  QualityControlInfo = QualityControlInfo,
                  phenoData = pheno_data,
                  useForExprs = "counts",
                  organism = org
                  gene_id_type = gene_id)
  
  return(scd)
}